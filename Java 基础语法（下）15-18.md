# Java åŸºç¡€è¯­æ³•ï¼ˆä¸‹ï¼‰15-18



## 15. `IO` æµ

### 1âƒ£ï¸æ¦‚å¿µ

- è¾“å…¥æµå’Œè¾“å‡ºæµï¼šå°†æ•°æ®ä»å¤–éƒ¨ä»‹è´¨è¾“å…¥åˆ°å†…å­˜ä¸ºè¾“å…¥æµï¼Œå°†æ•°æ®ä»å†…å­˜è¾“å…¥åˆ°å¤–éƒ¨ä»‹è´¨ä¸ºè¾“å‡ºæµã€‚
- å­—èŠ‚æµå’Œå­—ç¬¦æµï¼šä»¥å­—èŠ‚ä¸ºå•ä½çš„è¾“å…¥è¾“å‡ºæµï¼›å­—èŠ‚æµåœ¨è¯»å–æ–‡å­—å­—èŠ‚æ•°æ®åï¼Œä¸ç›´æ¥æ“ä½œè€Œæ˜¯æŸ¥è¯¢æŒ‡å®šç¼–ç è¡¨ï¼Œè·å–ç›¸åº”æ–‡å­—ï¼Œè¿™æ ·ä¸ºå­—ç¬¦æµï¼Œå³å­—èŠ‚æµ+ç¼–ç è¡¨ã€‚
- å­—èŠ‚æµçš„é¡¶å±‚çˆ¶ç±»ï¼šInputStream å’Œ OutputStream
- å­—ç¬¦æµçš„é¡¶å±‚çˆ¶ç±»ï¼šReader å’Œ Write



### 2âƒ£ï¸å­—ç¬¦æµæ“ä½œ

- **FileWrite** 

  ```java
  FileWrite fw = new FileWrite("demo.txt"); //åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè‹¥å­˜åœ¨åˆ™è¦†ç›–
  FileWrite fw = new FileWrite("demo.txt", true); // åœ¨æ–‡ä»¶å†…å®¹åè¿½åŠ 
  fw.write("abcdefa"); // å†™å…¥
  fw.flush(); // åˆ·æ´—ä¿å­˜ï¼Œç›¸å½“äºä¸å…³é—­æ–‡ä»¶ï¼Œç‚¹å‡»ä¿å­˜
  fw.close(); // ç›¸å½“äºå…³é—­æ–‡ä»¶å‰ä¿å­˜ï¼Œåªèƒ½ä¿å­˜ä¸€æ¬¡ï¼Œæµå°±å…³é—­äº†
  ```

  è¾“å‡ºæµå¼‚å¸¸è¾“å‡ºæ–¹å¼

  ```java
  FileWrite fw = null;
  try{
    fw = new FileWrite("demo.txt");
    fw.write("abdefa");
  
  }catch{
    if(fw != null) {
      // å› ä¸ºä¸‹é¢æ¯æ®µå¤„ç†éƒ½æ˜¯å°é—­çš„ï¼Œæ‰€ä»¥éœ€è¦å°†å¼•ç”¨å˜é‡åˆå§‹åŒ–åœ¨å¤–é¢
      try{
        fw.close(); // å› ä¸ºå¿…é¡»å…³é—­æµï¼Œæ‰€ä»¥æ”¾åœ¨ finally é‡Œé¢
      } catch (IOException){
        throw new RuntimeException("å…³é—­å¤±è´¥")
      }
    }
  }
  ```

- **FileReader** 

  æŒ‰ç…§å•ä¸ªå­—ç¬¦å–

  ```java
  FileReader fr = new FileReader("demo.txt");
  int ch;
  while ((ch = fr.read())!=-1){
    System.out.println(ch);
  }
  ```

  æŒ‰ç…§æ•°ç»„å–

  ```java
  char[] chr = new char[3];
  int len = 0;
  while ((len=fr.read(chr))!=-1){
    System.out.println(new String(chr, 0, len));
  }
  ```



### 3âƒ£ï¸ç¼“å†²åŒº â€”â€” BufferedWrite

ç¼“å†²åŒºï¼šå°†æ•°æ®ç¼“å­˜ï¼Œæé«˜å¯¹æ•°æ®è¯»å†™çš„æ•ˆç‡

```java
FileWriter fw = new FileWriter("buf.txt"); // å»ºç«‹ä¸€ä¸ªå†™å…¥æµ
BufferedWriter bf = new BufferedWriter(fw); // æé«˜æ•ˆç‡ï¼Œå°†å†™å…¥æµä¸ç¼“å†²åŒºè¿æ¥ã€‚åœ¨å†…å­˜ä¸Šå»ºä¸€ä¸ªç¼“å†²åŒºï¼Œå…ˆé€šè¿‡æµå†™å…¥åˆ°ç¼“å†²åŒºï¼Œç„¶åå†ç”¨ç¼“å†²åŒºçš„æ–¹æ³•å¯¹ç¼“å†²åŒºè¿›è¡Œæ“ä½œã€‚
bf.write("dashdjfa"); // è¯»å–çš„æ˜¯ç¼“å†²åŒºçš„å†…å®¹
bf.newLine(); // BufferedWriter ç‰¹æœ‰æ–¹æ³•
bf.write("dashdjfa"); 
bf.close(); //å®é™…æ˜¯å…³é—­äº†æµ
```



### 4âƒ£ï¸ç¼“å†²åŒº â€”â€” BufferedReader

```java
FileReader fr = new FileReader("buf.txt"); 
BufferedReader br = new BufferedReader(fr);
String line; // æŒ‰ç…§è¡Œæ¥è¯» readLine() ä¸ºç‰¹æœ‰æ–¹æ³•ï¼Œå½“æ²¡æ•°æ®äº†ï¼Œè¿”å› null
while ((line = br.readLine())!=null){
  system.out.println(line);
}
```



### 5âƒ£ï¸æµæ“ä½œå’Œç¼“å†²åŒºæ“ä½œçš„åŒºåˆ«

1. æµæ“ä½œ

   ç›´æ¥å°†å†…å­˜å’Œç¡¬ç›˜å»ºç«‹è¿æ¥ã€‚

   æ¯”å¦‚ï¼Œä½ å»å¨æˆ¿æ‹¿ä¸€ä¸ªåŒ…å­ï¼ˆæ•°æ®ï¼‰ï¼Œå›åˆ°é¤å…åƒï¼ˆå¤„ç†ï¼‰ï¼Œåƒå®Œä¸€ä¸ªï¼Œå†å›å»æ‹¿ã€‚

2. ç¼“å†²åŒº

   ä»¥è¯»æ•°æ®æ¥è¯´ï¼Œå…ˆå°†æ•°æ®ä»ç¡¬ç›˜å½“ä¸­é€šè¿‡æµæ“ä½œè¯»å…¥åˆ°å†…å­˜ä¸­ç¼“å†²åŒºä¸­ï¼Œç„¶åé€šè¿‡ç¼“å†²åŒºæ–¹æ³•åŒºå¤„ç†ç¼“å†²åŒºä¸­çš„æ•°æ®ã€‚

   æ¯”å¦‚ï¼Œä½ æ‹¿ç€ç¯®å­å»å¨æˆ¿ï¼Œå…ˆæŠŠåŒ…å­ï¼ˆæ•°æ®ï¼‰è£…åœ¨ç¯®å­ï¼ˆç¼“å†²åŒºï¼‰é‡Œï¼Œç„¶åæ‹¿åˆ°é¤å…ï¼Œå»åƒï¼ˆå¤„ç†ï¼‰ã€‚

3. åˆ©ç”¨ç¼“å†²åŒºæ“ä½œï¼Œæ•ˆç‡æ›´é«˜ã€‚

4. ç¼“å†²åŒºä¸­è¯»å†™å…·å¤‡ç‰¹æœ‰æ–¹æ³•ï¼Œæ¯”å¦‚å¯ä»¥è¯»å–ä¸€è¡Œæ•°æ®ï¼Œå†™ä¸ªæ¢è¡Œç¬¦ç­‰ã€‚




### 6âƒ£ï¸è£…é¥°è®¾è®¡æ¨¡å¼

**æ¦‚å¿µ** 

å¯¹ä¸€ç»„å¯¹è±¡çš„åŠŸèƒ½è¿›è¡Œå¢å¼ºæ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥æ¨¡å¼è§£å†³ã€‚

**ç»§æ‰¿å’Œè£…é¥°è®¾è®¡æ¨¡å¼çš„åŒºåˆ«** 

ç»§æ‰¿å¦‚æœåªæ˜¯ä¸ºäº†æ·»åŠ åŠŸèƒ½ï¼ŒåŠŸèƒ½å¤šäº†å°±ä¼šä½¿ç»§æ‰¿ä½“ç³»å˜å¾—è‡ƒè‚¿ï¼›

è£…é¥°è®¾è®¡æ¨¡å¼å°±æ˜¯ä¸ºäº†å°†å¯¹è±¡çš„åŠŸèƒ½å¢å¼ºï¼Œæ¯”å¦‚ç¼“å†²åŒºçš„åŸç†å°±æ˜¯è£…é¥°è®¾è®¡æ¨¡å¼ï¼Œä¸ºäº†å°†è¯»å–æ“ä½œå˜çš„é«˜æ•ˆã€‚

ç¼“å†²åŒºè¯»å–æ“ä½œä¸­ï¼Œå°†æµæ“ä½œè¿›è¡Œäº†è£…é¥°ï¼Œä½¿è¯»å–åŠŸèƒ½å˜æˆç¼“å†²åŒºçš„æ–¹æ³•ï¼Œæé«˜äº†è¯»å–æ•ˆç‡ã€‚

**è£…é¥°ç±»å’Œè¢«è£…é¥°ç±»éƒ½åœ¨åŒä¸€æ¥å£æˆ–çˆ¶ç±»** 
`java.io.Reader`

`java.io.FileReader ` è¢«è£…é¥°çš„å¯¹è±¡ï¼ŒåŸºæœ¬æµæ“ä½œ

`java.io.BufferedReader` è£…é¥°è®¾è®¡çš„å¯¹è±¡ï¼Œå°†åŸºæœ¬æµæ“ä½œè£…é¥°æˆç¼“å†²åŒºæ–¹æ³•ï¼Œé«˜æ•ˆ

æ€»ç»“ï¼šäºŒè€…éƒ½å±äºåŒä¸€ä½“ç³»ï¼Œè£…é¥°ä¸ºäº†è®©åŸå…ˆçš„å¯¹è±¡åŠŸèƒ½å¢å¼ºã€‚



### 7âƒ£ï¸å­—èŠ‚æµ

å­—èŠ‚æµçš„é¡¶å±‚çˆ¶ç±»ï¼šInputStream å’Œ OutputStream

åŸºæœ¬æ“ä½œå’Œå­—ç¬¦æµå·®ä¸å¤šï¼Œä¹Ÿå­˜åœ¨ç¼“å†²åŒºæ–¹æ³•ã€‚

ä¾‹å­ï¼šé€šè¿‡å­—èŠ‚æµå¯¹éŸ³ä¹æ–‡ä»¶è¿›è¡Œå¤åˆ¶ã€‚(é‡Œé¢ç”¨åˆ°ç¼“å†²åŒºæé«˜æ•ˆç‡ï¼Œä¸‹é¢ä»‹ç»)

```java
public static void (String[] args) throws IOException {
    //è¯»å–
    FileInputStream fis = new FileInputStream("E:\ceshi.mp3");
    BufferedInputStream bis = new BufferedInputStream(fis);
    //å†™å…¥
    FileOutputStream fos = new FileOutputStream("E:\ceshi1.mp3");
    BufferedOutputStream bos = new BufferedOutputStream(fos);
    /*æŒ‰å•ä¸ªå­—èŠ‚*/
    /*int ch = 0;
    while((ch = bis.read())!= -1){
        bos.write(ch);
    }*/

    /*æŒ‰ç…§æ•°ç»„æ¥å¤åˆ¶*/
    int len =0;
    byte[] chr = new byte[1024];
    while ((len = bis.read(chr))!= -1){

        bos.write(chr,0,len);
    }
    bis.close();
    bos.close();
}
```



### 8âƒ£ï¸é”®ç›˜è¾“å…¥æ–¹æ³•

1. æ‰“å¼€ä¸€ä¸ªé”®ç›˜è¾“å…¥æµï¼š`InputStream in = System.in;`

2. åˆ©ç”¨ in.read() æ–¹æ³•è¯»å–å­—èŠ‚ï¼Œå¯ä»¥æ”¾åœ¨ç¼“å†²åŒºæˆ–è€…æ•°ç»„æ¥è¿›è¡Œè½¬æ¢æˆå­—ç¬¦ä¸²ã€‚

   é”®ç›˜è¾“å…¥ï¼Œæ¯æ¬¡æŒ‰ä¸‹å›è½¦é”® `\r\n` å°±ä¼šè°ƒç”¨ä¸€æ¬¡è¾“å…¥æµè¿›è¡Œè¯»å–ï¼Œå¯¹äºå­—èŠ‚çš„è¯ï¼Œä¸€ä¸ªå›è½¦ç¬¦å·ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œå­—ç¬¦æµçš„è¯ï¼Œå›è½¦æ˜¯ä¸¤ä¸ªå­—ç¬¦ `\r\n`ã€‚



### 9âƒ£ï¸è½¬æ¢æµï¼ˆä¾¿äºé”®ç›˜å½•å…¥ï¼‰

å°†å­—èŠ‚æµå’Œå­—ç¬¦æµè¿›è¡Œäº’ç›¸è½¬æ¢

```java
/*ç¼“å†²åŒº  <--  å­—ç¬¦æµ  <--  å­—èŠ‚æµï¼ˆé”®ç›˜è¾“å…¥ï¼‰ï¼Œè§£ç */
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
/*ç¼“å†²åŒº  -->  å­—ç¬¦æµ  -->  å­—èŠ‚æµï¼ˆæ§åˆ¶å°æ˜¾ç¤ºï¼‰ï¼Œç¼–ç */
BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out));
String line = null;
while ((line = br.readLine())!=null){//æ£€æµ‹åˆ°æ¢è¡Œç¬¦å°±è¯»å–
    if(line.equals("over"))
        break;
    bw.write(line.toUpperCase());
    bw.newLine();//å­—ç¬¦æµç¼“å†²åŒºç‰¹æœ‰æ–¹æ³•
    bw.flush();
}
```

ä¸€ä¸ªæ–‡ä»¶å†…å®¹è¾“å…¥åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å†…ï¼ˆå‘ç° IO æµæŠ€æœ¯ä¹Ÿæ˜¯æœ‰è§„å¾‹ï¼‰

```java
/*ç¼“å†²åŒº  <--  å­—ç¬¦æµ  <--  å­—èŠ‚æµï¼ˆæºæ–‡ä»¶ï¼‰*/
BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream("buf.txt")));
/*ç¼“å†²åŒº  -->  å­—ç¬¦æµ  -->  å­—èŠ‚æµï¼ˆç›®çš„æ–‡ä»¶ï¼‰*/
BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream("b.txt")));
```



### ğŸ”Ÿ`IO` æµçš„æ“ä½œè§„å¾‹

1. ä¸¤å¤§ä½“ç³»ä¸¤å¤§é«˜æ•ˆï¼šå­—èŠ‚æµã€å­—ç¬¦æµã€ç¼“å†²åŒºæ–¹æ³• Buffered å’Œè½¬æ¢æµ
   - å­—ç¬¦æµçš„ä½“ç³»ï¼šReader å’Œ Writer
   - å­—èŠ‚æµçš„ä½“ç³»ï¼šInputStream å’Œ OutputStream
   - ç¼“å†²åŒºçš„é«˜æ•ˆï¼šåŠ ä¸Š Buffered
   - è½¬æ¢æµçš„é«˜æ•ˆï¼šé”®ç›˜è¾“å…¥å’Œé”®ç›˜è¾“å‡ºçš„æµè½¬æ¢

2. æ“ä½œçš„å…·ä½“è®¾å¤‡
   - ç¡¬ç›˜ï¼šFile
   - é”®ç›˜å’Œæ§åˆ¶å°ï¼šSystem.in å’Œ System.out
   - å†…å­˜ï¼šæ•°ç»„
   - ç½‘ç»œï¼šSocket æµ



### 1âƒ£ï¸1âƒ£ï¸è½¬æ¢æµçš„ç¼–ç è§£ç 

ç¼–ç è§„åˆ™å‘å±•å†å²

è®¡ç®—æœºæ˜¯ç¾å›½å…ˆå‘æ˜çš„ï¼Œæ‰€ä»¥æœ€åˆç”¨ 1 ä¸ªå­—èŠ‚è¡¨è¾¾è‹±æ–‡å­—æ¯å’Œç¬¦å·(**ASCII**)ï¼Œåæ¥ä¸­å›½å¼€å§‹ä½¿ç”¨è®¡ç®—æœºï¼Œæ˜¾ç¤ºå¯¹ ASCII è¿›è¡Œäº†æ‰©å……ï¼Œç”¨ 2 ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªæ±‰å­—ï¼Œå…ˆåå‡ºç°äº† **GB2312ï¼ˆå¸¸ç”¨ç®€ä½“ï¼‰ã€GBKï¼ˆåŒ…æ‹¬ç¹ä½“å’Œç”Ÿåƒ»å­—ï¼‰ã€GB18030ï¼ˆå°‘æ•°æ°‘æ—ï¼‰**ç¼–ç æ ¼å¼ã€‚

åæ¥ ISO å›½é™…æ ‡å‡†ç»„ç»‡å¼€å§‹ç»Ÿä¸€ä¸–ç•Œç¼–ç ï¼Œæœ€åˆæ˜¯ **UNICODE**ï¼ˆæ‰€æœ‰å­—ç¬¦éƒ½æ˜¯ 2 ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡å°±æµªè´¹å­˜å‚¨èµ„æºäº†ï¼‰ï¼Œç”±äºæŸäº›åŸå› é•¿æ—¶é—´å¾ˆéš¾æ¨å¹¿ã€‚ç›´åˆ°äº’è”ç½‘å‡ºç°ï¼Œç½‘ç»œä¼ è¾“ UTF-8 å’Œ UTF-16 å¯¹ UNICODE è¿›è¡Œäº†ç®—æ³•è½¬æ¢ï¼Œè€Œä¸”æ˜¯é‡‡ç”¨**å¯å˜å­—èŠ‚** çš„ç¼–ç æ–¹å¼ï¼Œæ¯”å¦‚ä¸€ä¸ªå­—æ¯å°±æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œæ±‰å­—æ˜¯ä¸‰ä¸ªå­—èŠ‚ï¼Œè¿™æ ·å°±ç»Ÿä¸€äº†ã€‚



ç¼–ç å’Œè§£ç 

FileWriter å’Œ FileReader æ˜¯è½¬æ¢æµçš„å­ç±»ï¼Œé‡‡ç”¨çš„æ˜¯ UTF-8ã€‚

ä½†æ˜¯å¦‚æœæƒ³è¦æŒ‡å®šç¼–ç è¡¨è¿›è¡Œæ“ä½œï¼Œå¿…é¡»ä½¿ç”¨è½¬æ¢æµæ“ä½œã€‚

ä¾‹å¦‚ï¼šå°†ä¸­æ–‡å­—ç¬¦ä¸²æŒ‰ç…§ UTF-8 å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå¹¶å°†æ–‡ä»¶å†…å®¹è¯»å–åˆ°æ§åˆ¶å°ã€‚

å…³é”®è¯ï¼šè¾“å‡ºè½¬æ¢æµï¼Œå­—èŠ‚è¾“å‡ºæµï¼Œè¾“å…¥è½¬æ¢æµï¼Œå­—èŠ‚è¯»å–æµ

```java
public static void outFileUTF() throws IOEeception{
  BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream("utf.txt"), "UTF-8")); // ç¼–ç 
  bw.write("ä½ å¥½");
  bw.close();
}
```

```java
public static void readFileByUTF() throws IOEeception{
  BufferedReader br = new BufferedReader(new OutputStreamReader(new FileInputStream("utf.txt"), "UTF-8")); // è§£ç 
  String line = br.readLine();
  System.out.println(line);
}
```

åˆ†æï¼šå¦‚æœé‡‡ç”¨æŒ‡å®šç¼–ç æ ¼å¼ï¼Œå¿…é¡»ä½¿ç”¨è½¬æ¢æµè¿›è¡Œæ“ä½œï¼ˆä»å­—ç¬¦æ•°æ®åˆ°å­—èŠ‚æ•°æ®ä¸­é—´å­˜åœ¨ä¸€ä¸ªç¼–ç è¡¨ï¼Œè¿™ä¸ªç¼–ç è¡¨å¯ä»¥æŒ‡å®šï¼‰ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ FileWrite ç­‰æ“ä½œï¼Œå› ä¸ºå…¶æ˜¯é»˜è®¤æœ¬åœ°ç¼–ç çš„ã€‚



### 1âƒ£ï¸2âƒ£ï¸File ç±»

File ç±»å¯¹æ–‡ä»¶å’Œæ–‡ä»¶å¤¹è¿›è¡Œæ“ä½œ

- è·å–

  æ–‡ä»¶åç§° getNameã€ç›¸å¯¹è·¯å¾„ getPathã€ç»å¯¹è·¯å¾„ getAbsolutePathã€æ–‡ä»¶å¤§å° lengthã€æ–‡ä»¶ä¿®æ”¹æ—¶é—´ lastModified

- åˆ›å»ºä¸åˆ é™¤

  åˆ›å»ºæ–‡ä»¶ createNewFileã€åˆ›å»ºç›®å½• mkdirã€å’Œ mkdirsï¼ˆå¯ä»¥åˆ›å»ºå¤šçº§ç›®å½•ï¼‰ã€åˆ é™¤æ–‡ä»¶ delete

- åˆ¤æ–­

  å­˜åœ¨æ€§ existsã€æ˜¯å¦ä¸ºæ–‡ä»¶ isFile å’Œç›®å½• isDirectory

- é‡å‘½åï¼šrenameTo

- è·å–ç³»ç»Ÿæ ¹ç›®å½•å’Œç£ç›˜å®¹é‡

  File.listRoots()ã€getTotalSpaceç­‰æ–¹æ³•

- è·å–ç›®å½•å†…å®¹

  è·å–å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½• listã€åªè·å–æ–‡ä»¶ listFile

- è¿‡æ»¤å™¨

  åœ¨è·å–ç›®å½•æˆ–æ–‡ä»¶æ—¶ï¼Œè¿‡æ»¤å‡ºè‡ªå·±æƒ³è¦çš„ã€‚è¿‡æ»¤å™¨æ˜¯ä¸€ç§æ¥å£ã€‚

  ```java
  File file = new File("E:\\");
  // list æ¥å—ä¸€ä¸ªè¿‡æ»¤å™¨å¯¹è±¡ï¼Œå†…éƒ¨ä¸æ–­è°ƒç”¨ accept æ–¹æ³•å¯¹æ•°ç»„è¿›è¡Œè¿‡æ»¤
  String[] str = file.list(new FilterByExt(".mp3"));
  // å®ç°è¿‡æ»¤å™¨æ¥å£ï¼Œè¦†ç›–è¿‡æ»¤çš„æ–¹æ³•
  class FilterByExt implements FilenameFilter{
    private String ext;
    FilterByExt(String ext){
      this.ext = ext;
    }
    
    @Override
    public boolean accept(File fir, String name) {
      return name.endsWith(ext);
    }
  }
  ```

- æ·±åº¦éå†æ–‡ä»¶å¤¹ï¼ˆé€’å½’å­¦ä¹ ï¼‰

  ç†è§£ï¼šè¿™ä¸ªæ–¹æ³•çš„åŠŸèƒ½å°±æ˜¯åˆ—å‡ºç›®å½•å†…çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥è‡ªå·±è°ƒç”¨è‡ªå·±è¿›è¡Œé€’å½’ã€‚

  ```java
  public static void listAll(File dir) {
    File[] list = dir.listFiles();
    for(int x-0; x<list.length;x++){
      if(list[x].isDirectory()){
        System.out.println(list[x].getname());
        listAll(list[x]); // é€’å½’è°ƒç”¨
      }
      else{
        System.out.println(list[x].getName());
      }
    }
  }
  ```

  è¯´æ˜é€’å½’å°±æ˜¯è‡ªå·±è°ƒç”¨è‡ªå·±ï¼Œä½†æ˜¯è¦æ³¨æ„é€’å½’çš„é€€å‡ºæ¡ä»¶ä»¥åŠé€’å½’æ¬¡æ•°ï¼ˆå› ä¸ºéœ€è¦ä¸æ–­è¿›æ ˆï¼Œæ‰€ä»¥æ¬¡æ•°å¤ªå¤šå¯èƒ½ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼‰ã€‚ç¨‹åºé‡Œé¢ç”¨é€’å½’å®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—ã€‚

  æ–¹æ³•1:é€’å½’å®ç°ï¼Œä½†æ˜¯æ•ˆç‡ä½

  ```java
  public static int getNum(int n){
    if(n==0)
      return 0;
    if(n==1)
      return 1;
    return getNum(n-1) + getNum(n-2);
  }
  ```

  æ–¹æ³•2:å¾ªç¯å®ç°ï¼Œæ•ˆç‡é«˜

  ```java
  public static int fibonacci(int n){
    int[] result = {0, 1};
    if (n < 2)
      return result[n];
    int fibNMinusOne = 1;
    int fibNMinusTwo = 0;
    int fibN = 0;
    for (i = 2; i <= n; i ++){
      fibN = fibNminusOne + fibNMinusTwo;// å°†å‰é¢çš„ç»“æœå‘åç§»åŠ¨ä¸€ä½ï¼Œæ±‚å’Œ
      fibNMinusTwo = fibNMinusOne;
      fibNMinusOne = fibN;
    }
    return fibN;
  }
  ```

- åˆ é™¤ç›®å½•ï¼ˆç›®å½•é‡Œé¢æœ‰å†…å®¹ï¼‰

  åŸç†ï¼šä»ç›®å½•æœ€å†…å±‚çš„æ–‡ä»¶å¼€å§‹åˆ é™¤ï¼Œè¿™å±‚æ–‡ä»¶éƒ½åˆ é™¤ä»¥ååœ¨åˆ é™¤è¿™å±‚çš„æ–‡ä»¶å¤¹

  æ–¹æ³•ï¼šæ·±åº¦æœç´¢ï¼Œæ·±åº¦åˆ é™¤

  ```java
  // æ·±åº¦æœç´¢ï¼Œä»å†…åˆ°å¤–è¿›è¡Œåˆ é™¤
  public static void removeAll(File dir){
    File[] file = dir.listFiles(); // ä»ä¸€å±‚ç›®å½•å†…çš„æ‰€æœ‰å†…å®¹
    for(File f: file){
      if (f.isDirectory()){
        removeAll(f); // æ˜¯ç›®å½•å°±é€’å½’ï¼Œä¸€ç›´é€’å½’åˆ°æœ€å†…å±‚ï¼Œç„¶åæ‰¾åˆ°æ–‡ä»¶åˆ é™¤æ‰
      }
      else{
        System.out.println(f.getAbsolutePath() + "---" + f.delete());
      }
    }
    // å½“è¿™å±‚æ–‡ä»¶éƒ½åˆ é™¤ä»¥åï¼Œå°±æŠŠè¿™å±‚çš„ç›®å½•éƒ½åˆ é™¤äº†
    System.out.println(dir.getAbsolutePath() + "---" + dir.delete());
  }
  ```



### 1âƒ£ï¸3âƒ£ï¸Properties é›†åˆ

Properties é›†åˆå±äº map çš„ hashtableï¼Œç”¨æ¥å’Œæµç›¸ç»“åˆã€‚



**ç‰¹ç‚¹** 

é›†åˆçš„é”®å’Œå€¼éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼›é›†åˆä¸­çš„æ•°ç»„å¯ä»¥ä¿å­˜åˆ°æµä¸­ï¼Œæˆ–è€…ä»æµä¸­è·å–æ•°æ®ï¼›é€šå¸¸å¤„ç†ä»¥é”®å€¼å¯¹å½¢å¼å­˜åœ¨çš„é…ç½®æ–‡ä»¶ã€‚

**é›†åˆçš„å­˜å–æ“ä½œå’Œä¿®æ”¹ ** 

å­˜ï¼š`pro.setproperty("zhangsan1", "21");` 

å–åªèƒ½ç”¨é”®çš„é›†åˆæ¥å–é”®å€¼

```java
Set<String> key = pro.stringPropertyNames();
for(String k:key){
  String val = pro.getProperty(k);
  System.out.println(k + ":" + val);
}
```

**æŒä¹…åŒ–** 

åŸç†ï¼šé›†åˆçš„æ•°æ®æœ¬æ¥åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœå†…å­˜ä¸€æ—¦é‡Šæ”¾ï¼Œæ•°æ®å°±ä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥å°†æ•°æ®é€šè¿‡æµæ“ä½œè¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œè¿›è¡Œç¡¬ç›˜ä¿å­˜ï¼Œè¾¾åˆ°æŒä¹…åŒ–ã€‚

å®ç°

```java
FileOutputStream fos = new FileOutputStream("prop.txt");
pro.store(fos, "name+age"); // æŒä¹…åŒ–æ–¹æ³•
```

ä¿®æ”¹é…ç½®ä¿¡æ¯

1. è¯»å–é…ç½®ä¿¡æ¯ï¼ˆå¿…é¡»æ˜¯é”®å€¼å¯¹å­˜å‚¨çš„æ–‡ä»¶ï¼‰

   ```java
   private static void loadFileProperties() throws IOException{
     Properties pro = new Properties();
     FileInputStream fis = new FileInputStream("prop.txt");
     pro.load(fis);
     pro.list(System.out); // ç”¨äºæµ‹è¯•æ‰“å°è¾“å‡º
   }
   ```

2. ä¿®æ”¹é…ç½®ä¿¡æ¯

   ```java
   private static void modifyFileProperties() throws IOException{
     File file = new File("prop.txt"); // åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨
     if (!file.exists()){
       file.createNewFile(); // ä¸å­˜åœ¨åˆ™åˆ›å»º
     }
     FileReader fr = new FileReader(file);
     Properties prop = new Properties();
     prop.load(fr); // è¯»å–åˆ°é›†åˆ
     // ä¿®æ”¹é›†åˆ
     prop.setProperty("zhangsan4", "34");
     // é‡æ–°å†™å…¥åˆ°æ–‡ä»¶ä¸­å»
     FileWriter fw = new FileWriter(file);
     prop.store(fw, "name + age");
     fw.close();
   }
   
   ```



### 1âƒ£ï¸4âƒ£ï¸`IO` åŒ…çš„å…¶å®ƒç±»

[IO åŒ…ä¸­çš„å…¶ä»–ç±»](https://www.cnblogs.com/linkworld/p/7519270.html)  

1. æ‰“å°æµ
   - PrintWriter å’Œ PrintWriter
   - ç›´æ¥æ“ä½œè¾“å…¥æµå’Œæ–‡ä»¶
2. åºåˆ—æµ
   - SequenceInputStream
   - å¯¹å¤šä¸ªè¾“å…¥æµè¿›è¡Œåˆå¹¶
3. æ“ä½œå¯¹è±¡
   - ObjectInputStream å’Œ ObjectOutputStream
   - è¢«æ“ä½œçš„å¯¹è±¡éœ€è¦å®ç° Serializable (æ ‡è®°æ¥å£)
4. RandomAccessFile
   - éšæœºè®¿é—®æ–‡ä»¶, è‡ªèº«å…·å¤‡è¯»å†™çš„æ–¹æ³•
   - ä¸æ˜¯ IO ä½“ç³»çš„å­ç±»,ç»§æ‰¿è‡ª Object
5. ç®¡é“æµ
   - PipedInputStream å’Œ PipedOutputStream
   - è¾“å…¥å’Œè¾“å‡ºå¯ä»¥ç›´æ¥è¿›è¡Œè¿æ¥, é€šè¿‡ç»“åˆçº¿ç¨‹ä½¿ç”¨



### 1âƒ£ï¸5âƒ£ï¸æ–‡ä»¶åˆ‡å‰²ä¸åˆå¹¶

æ€æƒ³

ä¸€èˆ¬æŒ‰ç…§å¤§å°æ¥åˆ‡å‰²ï¼Œå°†ä¸€ä¸ªæ–‡ä»¶æŒ‰ç…§ä¸€å®šå¤§å°ï¼ˆæ¯”å¦‚ 1 Mï¼‰è¿›è¡Œåˆ‡å‰²ï¼ˆä¸€ä¸ªè¾“å…¥æµï¼Œå¤šä¸ªæ–‡ä»¶è¾“å‡ºæµï¼‰ï¼Œå¹¶ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­è¡¨æ˜æºæ–‡ä»¶çš„åç§°å’Œç¢ç‰‡æ•°é‡ï¼›

åˆå¹¶ï¼Œå…ˆè¯»å–é…ç½®æ–‡ä»¶ï¼Œç¡®å®šæºæ–‡ä»¶åä»¥åŠç¢ç‰‡æ•°é‡ï¼Œå†åˆ©ç”¨åºåˆ—æµæ±Ÿå¤šä¸ªæ–‡ä»¶åˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­å»ï¼ˆå¤šè¾“å…¥æµå•è¾“å‡ºï¼‰ã€‚

#### åˆ‡å‰²

çŸ¥è¯†å‚¨å¤‡

åŸºç¡€çŸ¥è¯†éå¸¸é‡è¦ï¼Œå†å¤æ‚çš„åŠŸèƒ½ä¹Ÿæ˜¯ç”±ä¸€ä¸ªä¸ªåŸºç¡€çš„æ–¹æ³•ç»„æˆçš„ï¼Œç†Ÿç»ƒï¼Œæ·±åˆ»çš„ç†è§£ï¼ŒæŒæ¡åŸºç¡€çŸ¥è¯†

- å…³äºFile çš„æ„é€ å‡½æ•°çš„ç†è§£

  `File(File parent,String Child)` 

  `File(String parent,String child)` 

  æ ¹æ®ç»™å®š parentè·¯å¾„å å’Œ childè·¯å¾„å åˆ›å»ºä¸€ä¸ªæ–°çš„ Fileå®ä¾‹

- å…³äº count++ çš„ç†è§£

  å‘½ååˆ‡å‰²çš„æ–‡ä»¶æ˜¯ 1 2 3 4 ï¼Œä¸ºä»€ä¹ˆ count =5

  å¾ˆç®€å• i++; å…ˆä½¿ç”¨ï¼Œå†åŠ 1

  ```java
  int x=1;
  int y= x++;
  for(int i=0;i<4;i++){
    System.out.println(â€œy=â€+y);
    System.out.println(â€œx=â€+x);
  }
  ```

å¸¦ç€é…ç½®ä¿¡æ¯çš„åˆ‡å‰²

```java
/* åˆ‡å‰²æ–‡ä»¶æ—¶ï¼Œå¿…é¡»è®°å½•ä½è¢«åˆ‡å‰²æ–‡ä»¶çš„åç§°ï¼Œä»¥åŠåˆ‡å‰²å‡ºæ¥ç¢ç‰‡æ–‡ä»¶çš„ä¸ªæ•°ã€‚ ä»¥æ–¹ä¾¿äºåˆå¹¶
è¿™ä¸ªä¿¡æ¯ä¸ºäº†è¿›è¡Œæè¿°ï¼Œä½¿ç”¨é”®å€¼å¯¹çš„æ–¹å¼ã€‚ç”¨åˆ°äº†propertieså¯¹è±¡ */
Properties prop = new Properties();
/* å°†è¢«åˆ‡å‰²æ–‡ä»¶çš„ä¿¡æ¯ä¿å­˜åˆ°propé›†åˆä¸­ */
prop.setProperty("partcount", count+""); // ç¢ç‰‡æ–‡ä»¶çš„ä¸ªæ•°
prop.setProperty("filename", file.getName());
/* å¦‚æœæœ‰Nä¸ªç¢ç‰‡ï¼Œpropertieså‘½åä¸º N+1.properties */
fos = new FileOutputStream(new File(dir,count+".properties"));
/* å°†propé›†åˆä¸­çš„æ•°æ®å­˜å‚¨åˆ°æ–‡ä»¶ä¸­ */
prop.store(fos, "save file info");
fos.close();
fis.close();
```

å®Œæ•´åˆ‡å‰²ä»£ç ç¤ºä¾‹

```java
/* åˆ‡å‰²æ–‡ä»¶å¹¶å†™å‡ºåˆ‡å‰²é…ç½®æ–‡ä»¶ä¿¡æ¯ */
public class SplitFileDemo {
	
	// å®šä¹‰ä¸€ä¸ª 3Må¤§å°çš„ ç¼“å†²åŒº  å†™ 3145728æ¯”è¾ƒå¥½ï¼Œå†™ 1024*1024*3,
	// ç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œè¿˜è¦å…ˆè¿ç®—ä¸€éï¼Œå½±å“æ•ˆç‡
	private static final int SIZE = 3145728;
	
	public static void main(String[] args) throws IOException {
		
		File file = new File("E:\\tm.mp3");
		splitFile(file);

	}

	private static void splitFile(File file) throws IOException {
		
		// ç”¨è¯»å–æµ å…³è”æºæ–‡ä»¶
		FileInputStream fis = new FileInputStream(file);
		// å®šä¹‰ä¸€ä¸ª 3Mçš„ç¼“å†²åŒº
		byte[] buf = new byte[SIZE];
		
		// åˆ›å»ºç›®çš„
		FileOutputStream fos = null;
		int len = 0;
		int count = 1;
		
		/*
		 *  åˆ‡å‰²æ–‡ä»¶æ—¶ï¼Œå¿…é¡»è®°ä½è¢«åˆ‡å‰²çš„æ–‡ä»¶çš„åç§°ï¼Œä»¥åŠåˆ‡å‰²å‡ºæ¥çš„ç¢ç‰‡æ–‡ä»¶çš„ä¸ªæ•°
		 *  ä»¥æ–¹ä¾¿åˆå¹¶ã€‚
		 *  è¿™ä¸ªä¿¡æ¯ä¸ºäº†è¿›è¡Œæè¿°ï¼Œä½¿ç”¨é”®å€¼å¯¹çš„æ–¹å¼ï¼Œç”¨åˆ°äº† propertieså¯¹è±¡
		 */
		
		Properties prop = new Properties();
		
		File dir = new File("E:\\partFiles"); // å®šä¹‰åˆ‡å‰²æ–‡ä»¶å­˜æ”¾çš„ä½ç½®
		if(!dir.exists()){
			dir.mkdirs();
		}
		
		while((len=fis.read(buf))!=-1){
			
			fos = new FileOutputStream(new File(dir,(count++)+".part"));
			fos.write(buf,0,len);
			fos.close();
		}
		
		// å°†è¢«åˆ‡å‰²æ–‡ä»¶çš„ä¿¡æ¯ ä¿å­˜åˆ° propé›†åˆä¸­
		/*
		 *  setProperty(String value,String key)
		 *  è°ƒç”¨ Hashtableçš„æ–¹æ³• put
		 */
		prop.setProperty("partcount",count+"");
		prop.setProperty("filename",file.getName());
		
		// å¦‚æœæœ‰Nä¸ªç¢ç‰‡ï¼Œpropertieså‘½åä¸º N+1.properties
		fos = new FileOutputStream(new File(dir,count+".properties"));
		
		// å°† propé›†åˆä¸­çš„æ•°æ® å­˜å‚¨åˆ°æ–‡ä»¶ä¸­
		prop.store(fos,"save file info");
		
		fos.close();
		fis.close();
	}
}
```



#### åˆå¹¶

1. å…ˆæ‹¿åˆ°è¯¥ç›®å½•ä¸‹çš„ é…ç½®æ–‡ä»¶å¯¹è±¡

   é…ç½®ä¿¡æ¯æ‹¿ä¸åˆ°ï¼Œæˆ–è€…æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°±ä¸ç”¨åˆå¹¶äº†
   é…ç½®æ–‡ä»¶æ€ä¹ˆæ‹¿

   æˆ‘ä»¬ä¸çŸ¥é“é…ç½®æ–‡ä»¶çš„ä¿¡æ¯ï¼Œä½†æ˜¯çŸ¥é“é…ç½®æ–‡ä»¶çš„æ‰©å±•åæ˜¯ .properties
   æ‰€ä»¥è¦å‡†å¤‡ä¸€ä¸ªè¿‡æ»¤å™¨

   ```java
   File[] files = dir.listFiles(new SuffixFilter(".properties")); // è·å–æŒ‡å®šç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶å¯¹è±¡
   ```

2. è®°å½•é…ç½®æ–‡ä»¶å¯¹è±¡

   ```java
   File confile = files[0];
   ```

3. è·å–è¯¥æ–‡ä»¶ä¸­çš„ä¿¡æ¯

   ```java
   Properties prop = new Properties();
   FileInputStream fis = new FileInputStream(confile);
   prop.load(fis);
   String filename = prop.getProperty(â€œfilenameâ€);
   int count = Integer.parseInt(prop.getProperty(â€œpartcountâ€));
   ```

4. è·å–è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰ç¢ç‰‡æ–‡ä»¶

   ```java
   File[] partFiles = dir.listFiles(new SuffixFilter(".part"));
   ```

5. å°†ç¢ç‰‡æ–‡ä»¶å’Œæµå¯¹è±¡å…³è” å¹¶å­˜å‚¨åˆ°é›†åˆä¸­

   ```java
   ArrayList al = new ArrayList();
   for(int x=0; x<partFiles.length; x++){
   al.add(new FileInputStream(partFiles[x]));
   }
   ```

6. å°†å¤šä¸ªæµåˆå¹¶æˆä¸€ä¸ªåºåˆ—æµ

è¿‡æ»¤å™¨ä»£ç 

```java
public class SuffixFilter implements FilenameFilter{
	
	private String suffix;
	
	public SuffixFilter(String suffix){
		super();
		this.suffix = suffix;
	}

	public boolean accept(File dir, String name) {
		return name.endsWith(suffix);
	}
}
```

å®Œæ•´åˆå¹¶ä»£ç ç¤ºä¾‹

```java
public class MergeFileDemo {

	/**
	 *    æ–‡ä»¶åˆå¹¶
	 * @throws IOException 
	 */
	public static void main(String[] args) throws IOException {
		
		File dir = new File("E:\\partFiles"); // å…ˆå…³è” è¦åˆå¹¶çš„æ–‡ä»¶
		mergeFile(dir);
	}

	private static void mergeFile(File dir) throws IOException {
		
		// åˆå¹¶æ–‡ä»¶ï¼Œç»™çš„æ˜¯æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰ä¸€å †æ–‡ä»¶/ç›®å½•
		// è·å–æŒ‡å®šç›®å½•ä¸‹çš„ é…ç½®æ–‡ä»¶å¯¹è±¡
		File[] files = dir.listFiles(new SuffixFilter(".properties"));
		
		if(files.length !=1){
			throw new RuntimeException(dir+",è¯¥ç›®å½•ä¸‹æ²¡æœ‰propertiesæ‰©å±•åçš„æ–‡ä»¶æˆ–è€…ä¸å”¯ä¸€");
		}
		// è®°å½•é…ç½®æ–‡ä»¶å¯¹è±¡
		File confile = files[0];
		
		// è·å–è¯¥æ–‡ä»¶ä¸­çš„ä¿¡æ¯
		Properties prop = new Properties();
		FileInputStream fis = new FileInputStream(confile);
		prop.load(fis);
		
		String filename = prop.getProperty("filename");
		int count = Integer.parseInt(prop.getProperty("partcount"));
		
		// è·å–è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰ç¢ç‰‡æ–‡ä»¶
		File[] partFiles = dir.listFiles(new SuffixFilter(".part"));
		if(partFiles.length !=(count-1)){
			throw new RuntimeException(" ç¢ç‰‡æ–‡ä»¶ä¸ç¬¦åˆè¦æ±‚ï¼Œä¸ªæ•°ä¸å¯¹!åº”è¯¥"+count+"ä¸ª");
		}
		
		// å°†ç¢ç‰‡æ–‡ä»¶ å’Œ æµå¯¹è±¡ å…³è”ï¼Œå¹¶å­˜å‚¨åˆ°é›†åˆä¸­
		ArrayList<FileInputStream> al = new ArrayList<FileInputStream>();
		for(int x=0;x<partFiles.length;x++){
			al.add(new FileInputStream(partFiles[x]));
		}
		
		// å°†å¤šä¸ªæµ åˆå¹¶æˆä¸€ä¸ªæµ
		Enumeration<FileInputStream> en = Collections.enumeration(al);
		SequenceInputStream sis = new SequenceInputStream(en);
		FileOutputStream fos = new FileOutputStream(new File(dir,filename));
		
		byte[] buf = new byte[1024];
		int len = 0;
		while((len=sis.read(buf))!=-1){
			fos.write(buf,0,len);
		}
		fos.close();
		sis.close();
	}
}
```



### 1âƒ£ï¸6âƒ£ï¸å¯¹è±¡åºåˆ—åŒ–å’Œååºåˆ—åŒ–

**Javaåºåˆ—åŒ–**æ˜¯æŒ‡æŠŠJavaå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ï¼›è€Œ**Javaååºåˆ—åŒ–**æ˜¯æŒ‡æŠŠå­—èŠ‚åºåˆ—æ¢å¤ä¸ºJavaå¯¹è±¡çš„è¿‡ç¨‹ã€‚

**åŸç†** 

å°†å¯¹è±¡æŒ‰ç…§åºåˆ—çš„æ–¹å¼å­˜å‚¨åˆ°æ–‡ä»¶ä¸­ï¼Œè¿›è¡ŒæŒä¹…åŒ–ä¿å­˜ï¼Œç„¶åä¹Ÿå¯ä»¥è¿›è¡Œååºåˆ—åŒ–ï¼Œå°†å¯¹è±¡è¯»å‡ºï¼ˆå¯¹è±¡æ‰€å¯¹åº”çš„ç±»å¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£ Serializableï¼‰ã€‚

**æ“ä½œå®ä¾‹** 

```java
public static void readObj() throws IOException, ClassNotFoundException{
  ObjectInputStream ois = new ObjectInputStream(new FileInputStream(PATH));
  Person p  = (Person)ois.readObject();
  System.out.println(p.getName() + "|" + p.getAge());
  ois.close();
}
```

```java
public static void writeObj() throws IOException {
  // å¯¹è±¡è¾“å‡ºæµå’Œæ–‡ä»¶è¾“å‡ºæµç›¸ç»“åˆï¼ŒæŠŠå¯¹è±¡è¾“å‡ºåˆ°æ–‡ä»¶
  ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(PATH));
  oos.writeObject(new Person("å¼ ä¸‰", 30));
  oos.close();
}
```

**åºåˆ—åŒ–æ¥å£** Serializable

ä½œç”¨ï¼šæ¯ä¸ªç±»åªæœ‰å®ç°è¿™ä¸ªæ¥å£æ‰èƒ½è¿›è¡Œåºåˆ—åŒ–ï¼Œåœ¨æ¯ä¸ªç±»è¿›è¡Œåºåˆ—åŒ–æ—¶ï¼Œä¼šé»˜è®¤è®¡ç®—å‡ºä¸€ä»½ serializableVersionID ç”¨æ¥æ§åˆ¶ç±»çš„ç‰ˆæœ¬ï¼Œå¦‚æœè¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™ï¼Œå‘ç°å½“å‰çš„ç±»å‘ç”Ÿäº†å˜åŒ–ï¼ˆåºåˆ—åŒ–ä¹Ÿä¼šè‡ªå·±å˜åŒ–ï¼‰ï¼Œå°±ä¼šå‘ç”Ÿå¼‚å¸¸ã€‚å› ä¸ºæ–‡ä»¶ä¸­å­˜å‚¨çš„åºåˆ—å·å’Œå½“å‰ç±»çš„åºåˆ—å·ä¸ä¸€è‡´ã€‚

ä¸è¿‡åºåˆ—å·çš„æ•°å­—ä¹Ÿå¯ä»¥æ˜¯è‡ªå·±è®¾ç½®çš„ï¼š

`ANY-ACCESS-MODIFIER static final long serializableVersionID = 42L; ` 

å®šä¹‰åä¸ç®¡ç±»å¦‚ä½•å˜åŒ–ï¼Œç‰ˆæœ¬å·éƒ½æ˜¯å›ºå®šçš„ã€‚

**å…³é”®å­— transient** 

éé™æ€æ•°æ®ä¸æƒ³è¢«åºåˆ—åŒ–å¯ä»¥ä½¿ç”¨è¿™ä¸ªå…³é”®å­—ä¿®é¥°ã€‚

é™æ€æ•°æ®ä¹Ÿæ˜¯ä¸å†™å…¥åºåˆ—åŒ–çš„ï¼Œä½†æ˜¯å¦‚æœæœ‰ä¸ªæ•°æ®ä¸æƒ³é™æ€åŒ–ä¹Ÿä¸æƒ³å†™å…¥åºåˆ—åŒ–ï¼Œå°±ç”¨è¿™ä¸ªå…³é”®å­—ã€‚



### 1âƒ£ï¸7âƒ£ï¸ RandomAccessFile

**ç‰¹ç‚¹** 

**æ”¯æŒéšæœºè®¿é—®æ–‡ä»¶çš„è¯»å–å’Œå†™å…¥** ï¼›é‡Œé¢ç»´æŠ¤ç€ä¸€ä¸ªå¤§å‹çš„ byte æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡æŒ‡é’ˆæ“ä½œæ•°ç»„ä¸­çš„å…ƒç´ ï¼›å¯ä»¥åˆ©ç”¨ getFilePointer æ–¹æ³•è¯»å–æŒ‡é’ˆçš„ä½ç½®ï¼Œå¹¶é€šè¿‡ seek æ–¹æ³•è®¾ç½®æŒ‡é’ˆçš„ä½ç½®ï¼›å…¶å®æ˜¯å¯¹å­—èŠ‚è¾“å‡ºæµçš„è¾“å…¥æµè¿›è¡Œå°è£…ï¼›æºå’Œç›®çš„åªèƒ½æ˜¯æ–‡ä»¶ã€‚

ä»æ“ä½œä¸Šçœ‹ï¼Œå°±æ˜¯å°†æ•°æ®å†™åˆ°ä¸€ä¸ª byte æ•°ç»„ä¸­ï¼Œè¯»å–çš„è¯ï¼Œä¹Ÿæ˜¯åœ¨æ“ä½œåšä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å¯ä»¥éšæœºæŒ‡å®šä½ç½®ã€‚

**æ“ä½œå®ä¾‹** ï¼ˆå¯¹æ–‡ä»¶è¿›è¡Œè¯»å†™ï¼‰

```java
private static void readFile() throws Exception {
  RandomAccessFile ras = new RandomAccessFile("ran.txt", "rw");
  byte[] name = new byte[6];
  raf.seek(1*10); // å¯ä»¥æŒ‡å®šä½ç½®è¿›è¡Œéšæœºè¯»å–
  raf.read(name);
  int age = raf.readIn(); // è¯»æ•´æ•°
  String n = new String(name); // å°†æ•°ç»„è½¬æˆå­—ç¬¦ä¸²
  System.out.println(n + ":" + age);
  raf.close();
}
```

```java
private static void writeFile() throws Exception {
  RandomAccessFile ras = new RandomAccessFile("ran.txt", "rw");
  raf.write("å°æ˜".getBytes()); // æ±‰å­—é»˜è®¤æ˜¯ UTF-8 ç¼–ç  6 ä¸ªå­—èŠ‚
  raf.writeInt(100); // 4 ä¸ªå­—èŠ‚
  raf.write("å°å¼º".getBytes());
  raf.writeInt(101);
  raf.close();
}
```



### 1âƒ£ï¸8âƒ£ï¸ç®¡é“æµ

åŸç†ï¼šåœ¨è¾“å‡ºå’Œè¾“å…¥ä¹‹é—´å»ºç«‹è”ç³»ï¼›ä¸€ç«¯åˆ©ç”¨ç®¡é“è¾“å‡ºæµè¾“å‡ºæ•°æ®ï¼Œå¦ä¸€ç«¯åˆ©ç”¨ç®¡é“è¾“å…¥æµè¿›è¡Œè¯»å–æ•°æ®ï¼Œä¸¤ä¸ªç®¡é“æµåˆ†åˆ«åœ¨ä¸¤ä¸ªçº¿ç¨‹ä¸­ï¼Œè¿™æ ·ä¹Ÿå°±å®ç°äº†å¤šçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚

æ“ä½œå®ä¾‹

```java
public class PipeStreamDemo {
  public static void main(String[] args) throws IOException {
    PipedInputStream pis = new PipedInputStream(); // ç®¡é“è¾“å…¥æµ
    PipedOutputStream pos = new PipedOutputStream();
    pos.connect(pis); // å°†è¾“å…¥æµå’Œè¾“å‡ºæµè¿›è¡Œè¿æ¥
    /* åˆ›å»ºçº¿ç¨‹å¹¶è¿è¡Œï¼Œç®¡é“è¾“å‡ºæµçº¿ç¨‹å°†æ•°æ®è¾“å‡ºï¼Œç®¡é“è¯»å–æµè¯»å–æ•°æ®*/
    new Thread(new Output(pos)).start();
    new Thread(new Input(pis)).start();
  }
}
```

```java
/* ç®¡é“è¾“å‡ºæµç”±çº¿ç¨‹æ¥ç»´æŠ¤ */
class Output implements Runnable{
  private PipeOutputStream pos;
  Output(PiprOutStream pos){
    this.pos = pos;
  }
  @Override
  public void run(){
    try{
      pos.write("æˆ‘æ˜¯ç®¡é“ï¼Œæˆ‘æ¥ç»™ä½ æ•°æ®".getBytes());
    }catch(IOException){
      e.printStackTrace();
    }
  }
}
```

```java
class Input implements Runnable{
  private PipeInputStream pis;
  Input(PiprInStream pis){
    this.pis = pis;
  }
  @Override
  public void run(){
    byte[] b = new byte[1024];
    try{
      int len = pis.read(b);
      String str = new String(b, 0, len);
      System.out.println();
    }catch (IOException) {
      e.printlnStackTrace();
    }
  }
}
```



### 1âƒ£ï¸9âƒ£ï¸DataInputStream å’Œ DataOutputStream

åªç”¨æ¥å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹çš„



### 2âƒ£ï¸0âƒ£ï¸ByteArrayInputStream å’Œ ByteArrayOutputStream

åˆ©ç”¨æµçš„æ€æƒ³å¤„ç†æ•°ç»„



### 2âƒ£ï¸1âƒ£ï¸ç¼–ç é—®é¢˜

- ä¸€ä¸ªæ±‰å­—å¦‚æœè§£ç å‡ºé”™ï¼Œè¿˜æœ‰å¯èƒ½è¯»å‡ºçœŸæ­£æ±‰å­—å†…å®¹çš„ï¼Œéœ€è¦å°†è§£ç ä¹‹åçš„å†…å®¹ç¼–ç ä¸ºå­—èŠ‚ç ï¼Œå†ç”¨ GBK è¿›è¡Œè§£æ

  ```java
  byte[] byt = "è°¢è°¢".getBytes("GBK");
  String str = new String(byt, "UTF-8");
  byte[] byt1 = str.getBytes("UTF-8");
  String str1 = new String(byt1, "GBK");
  System.out.println(str1);
  ```

- å°ç»ƒä¹ 

  ç¼–å†™ä¸€ä¸ªæˆªå–å­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œåœ¨ä¸€ä¸ªä¸­è‹±æ–‡æ··åˆçš„å­—ç¬¦ä¸²ä¸­ï¼Œæˆªå–æœ‰æ•ˆå­—èŠ‚ï¼Œæ˜¾ç¤ºå‡ºæ­£ç¡®çš„ä¸­è‹±æ–‡å­—ç¬¦ã€‚

  è¾“å…¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å’Œå­—èŠ‚æ•°ï¼Œè¾“å‡ºä¸ºæŒ‰å­—èŠ‚æˆªå–çš„å­—ç¬¦ä¸²ã€‚ ä½†æ˜¯è¦ä¿è¯æ±‰å­—ä¸è¢«æˆªåŠä¸ªï¼Œå¦‚â€œæˆ‘ABCâ€4ï¼Œåº”è¯¥æˆªä¸ºâ€œæˆ‘ABâ€ï¼Œè¾“å…¥â€œæˆ‘ABCæ±‰DEFâ€ï¼Œ6ï¼Œåº”è¯¥è¾“å‡ºä¸ºâ€œæˆ‘ABCâ€è€Œä¸æ˜¯â€œæˆ‘ABC+æ±‰çš„åŠä¸ªâ€ã€‚

  GB2312ã€GBKã€GB18030ï¼ŒCP936ä»¥åŠCNS11643éƒ½æ»¡è¶³æ¡ä»¶ -- ä¸­æ–‡æ˜¯å ç”¨2ä¸ªå­—èŠ‚çš„ï¼Œè‹±æ–‡æ˜¯å ç”¨1ä¸€ä¸ªå­—èŠ‚ ã€‚

  å› ä¸ºä¸­æ–‡è½¬æ¢ä¸ºbyteå­—èŠ‚ï¼Œéšç€ç¼–ç çš„ä¸åŒï¼Œè½¬æ¢çš„å­—èŠ‚é•¿åº¦ä¹Ÿä¼šä¸åŒï¼Œå¦‚ç¼–ç ä¸ºUTF-8ï¼Œä¸€ä¸ªä¸­æ–‡å­—ç¬¦ä¸²è½¬æ¢ä¸ºbyteå ä¸‰ä¸ªå­—èŠ‚.

  ```java
  package com.suanfa;
   
  import java.io.UnsupportedEncodingException;
   
  public class CharactersSplit {
  	/**
  	 * @param text
  	 *            ç›®æ ‡å­—ç¬¦ä¸²
  	 * @param length
  	 *            æˆªå–é•¿åº¦
  	 * @param encode
  	 *            é‡‡ç”¨çš„ç¼–ç æ–¹å¼
  	 * @return
  	 * @throws UnsupportedEncodingException
  	 */
   
  	public static String substring(String text, int length, String encode)
  			throws UnsupportedEncodingException {
  		if (text == null) {
  			return null;
  		}
  		StringBuilder sb = new StringBuilder();
  		int currentLength = 0;
  		for (char c : text.toCharArray()) {
  			currentLength += String.valueOf(c).getBytes(encode).length;
  			if (currentLength <= length) {
  				sb.append(c);
  			} else {
  				break;
  			}
  		}
  		return sb.toString();
  	}
   
  	public static void main(String[] args) throws UnsupportedEncodingException {
  		String text = "æˆ‘ABCæ±‰DEF";
  		int length1 = 3;
  		int length2 = 6;
  		String[] encodes = new String[] { "GB2312", "GBK", "GB18030", "CP936",
  				"CNS11643", "UTF-8" };
   
  		for (String encode : encodes) {
  			System.out.println(new StringBuilder().append("ç”¨").append(encode)
  					.append("ç¼–ç æˆªå–å­—ç¬¦ä¸² -- ã€").append(text).append("ã€‘")
  					.append(length1).append("ä¸ªå­—èŠ‚çš„ç»“æœæ˜¯ã€")
  					.append(substring(text, length1, encode)).append("ã€‘")
  					.toString());
  			System.out.println(new StringBuilder().append("ç”¨").append(encode)
  					.append("ç¼–ç æˆªå–å­—ç¬¦ä¸² -- ã€").append(text).append("ã€‘")
  					.append(length2).append("ä¸ªå­—èŠ‚çš„ç»“æœæ˜¯ã€")
  					.append(substring(text, length2, encode)).append("ã€‘")
  					.toString());
  		}
   
  	}
  }
  ```





## 16. ç½‘ç»œç¼–ç¨‹

### 1âƒ£ï¸OSIå‚è€ƒæ¨¡å‹ï¼ˆä¸ƒå±‚ï¼‰

1. **ç‰©ç†å±‚** 

   å„ç§**ä¼ è¾“ä»‹è´¨**ç­‰ã€‚ä¼ è¾“æ¯”ç‰¹æµï¼Œå°†æ•°å­—ä¿¡å·è½¬æˆåº—ä¿¡å·è¿›è¡Œä¼ è¾“ï¼Œåˆ°ç›®çš„åœ°åå†è½¬æˆæ•°å­—ä¿¡å·ã€‚

2. **æ•°æ®é“¾è·¯å±‚** 

   å°†ä»ç‰©ç†å±‚æ¥å—çš„æ•°æ®è¿›è¡Œ **MACåœ°å€** çš„å°è£…ä¸è§£å°è£…ã€‚è¿™å±‚æ•°æ®å«åš**å¸§**ï¼Œè®¾å¤‡ä¸º**äº¤æ¢æœº**ã€‚

3. **ç½‘ç»œå±‚** 

   ä¸»è¦ä¸‹å±‚çš„æ•°æ®è¿›è¡Œ **IPåœ°å€** çš„å°è£…å’Œè§£å°è£…ã€‚è¿™å±‚æ•°æ®å«åš**æ•°æ®åŒ…**ï¼Œè®¾å¤‡ä¸º**è·¯ç”±å™¨**ã€‚

4. **ä¼ è¾“å±‚**

   å®šä¹‰äº†ä¸€äº›**ä¼ è¾“åè®®**ä¸ç«¯å£å·ï¼Œè¿™å±‚æ•°æ®å«åš**æ®µ**ã€‚

5. **ä¼šè¯å±‚**

   è®¾å¤‡ä¹‹é—´äº’ç›¸è®¤è¯†

6. **è¡¨ç¤ºå±‚** 

   å°†æ•°æ®è¿›è¡Œè§£æï¼ˆæŠŠè®¡ç®—æœºæ•°æ®è½¬æˆäººèƒ½å¤Ÿè®¤è¯†çš„ä¿¡æ¯ï¼Œå¦‚è§†é¢‘ã€å›¾ç‰‡ç­‰ï¼‰ã€‚

7. **åº”ç”¨å±‚** 

   ç»ˆç«¯åº”ç”¨ï¼Œæ¯”å¦‚æµè§ˆå™¨ç­‰ã€‚

ä»åº”ç”¨å±‚ â€”â€”> ç‰©ç†å±‚ï¼Œå«åšå°è£…ï¼ˆå°åŒ…ï¼‰ï¼Œåè¿‡æ¥å«åšè§£å°è£…ï¼ˆæ‹†åŒ…ï¼‰ã€‚

<img src="./img/OSIä¸ƒå±‚æ¨¡å‹.jpeg" alt="img" style="zoom:100%;" />



### 2âƒ£ï¸TCP/IP å‚è€ƒæ¨¡å‹ï¼ˆå››å±‚ï¼‰

å°† OSI æ¨¡å‹è¿›è¡Œåˆå¹¶ã€‚

<img src="./img/TCP-IPå››å±‚æ¨¡å‹.jpeg" alt="img" style="zoom:100%;" />

 

### 3âƒ£ï¸ç½‘ç»œä¸‰è¦ç´ 

ç½‘ç»œä¸‰è¦ç´  â€”â€” IPåœ°å€ã€ç«¯å£å·ã€ä¼ è¾“åè®®

- IP åœ°å€

  è®¡ç®—æœºä¸Šç½‘çš„ç½‘ç»œæ ‡è¯†ï¼Œæœ‰ Ipv4 ï¼ˆ4éƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†æ•°å€¼ä¸º 0-255ï¼‰ï¼Œæœ€æ–°æœ‰ Ipv6 ï¼ˆåœ°å€ä¸å¤Ÿåˆ†é…ï¼ŒåŠ ä¸Šå­—æ¯äº†ï¼‰ï¼ŒIP åœ°å€ä¸å¥½è®°å¿†ï¼Œåé¢ç”¨ä¸»æœºåæè¿°ã€‚

- ç«¯å£å·

  æœ‰æ•ˆç«¯å£ 0 - 65535ï¼Œå…¶ä¸­ 0 - 1024 ç³»ç»Ÿä¿ç•™ã€‚ç”¨æ¥æ ‡è¯†è¿›ç¨‹çš„é€»è¾‘åœ°å€ï¼Œå‘é€æ•°æ®ç»™æŸä¸ªè½¯ä»¶ï¼Œéœ€è¦çŸ¥é“è¿™ä¸ªè½¯ä»¶ç«¯å£å€¼ã€‚

- ä¼ è¾“åè®®

  æœ€å¸¸è§çš„ TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’Œ UDPï¼ˆä¼ è¾“æŠ¥æ–‡åè®®ï¼‰ã€‚

  1. TCP

     éœ€è¦å»ºç«‹è¿æ¥ï¼Œä¸‰æ¬¡æ¡æ‰‹ï¼ˆ1. åœ¨ï¼Ÿ 2. å—¯ã€‚ 3. å¥½çš„ã€‚ï¼‰

  2. UDP

     æŠŠæ•°æ®å°è£…æˆæ•°æ®åŒ…ï¼Œä¸éœ€è¦å»ºç«‹è¿æ¥ï¼ˆç›´æ¥å‘å‡ºå»ï¼Œä¸ç®¡å¯¹æ–¹åœ¨ä¸åœ¨ï¼‰ï¼Œå¤§å°é™åˆ¶ 64Kï¼Œæ— è¿æ¥ã€ä¸å¯é ï¼Œä½†é€Ÿåº¦å¿«ã€‚



### 4âƒ£ï¸IPå¯¹è±¡ â€”â€” InetAddress

å¯ä»¥è·å¾—ä¸»æœºåå’Œ IP åœ°å€ç­‰æ“ä½œ

```java
// è·å–æœ¬åœ° IP
InetAddress ip = InetAddress.getLocalHost();
System.out.println(ip.getHostName());
System.out.println(ip.getHostAddress());
```



### 5âƒ£ï¸åŸŸåè§£æ

IP åœ°å€å’ŒåŸŸåä¸€ä¸€å¯¹åº”ï¼Œä¾¿äºè®¿é—®

DNS åŸŸåè§£ææœåŠ¡å™¨

å½“æˆ‘ä»¬è®¿é—®åŸŸåæ—¶ï¼Œå…ˆå»æ‰¾åˆ° DNS æœåŠ¡å™¨è¿›è¡ŒåŸŸåè§£æã€‚å®é™…å…ˆè®¿é—®æœ¬åœ°çš„è§£ææ–‡ä»¶ï¼Œè§£æä¹‹åè®¿é—®å¯¹åº” IP åœ°å€çš„æœåŠ¡å™¨ã€‚



### 6âƒ£ï¸UDP

- Socketï¼šé€šä¿¡çš„ä¸¤ç«¯ï¼Œæ•°æ®åœ¨ Socket ç›´æ¥è¿›è¡Œé€šä¿¡ï¼ŒSocket ä¹‹é—´è¿›è¡Œ `IO` ä¼ è¾“ã€‚
- UDP ä¼ è¾“å‘é€ç«¯

UDPå‘é€ç«¯

```java
/*
1. å»ºç«‹ UDP çš„ socket æœåŠ¡
2. å°†å‘é€çš„æ•°æ®å°è£…åœ¨æ•°æ®åŒ…ä¸­
3. é€šè¿‡ UDP çš„ scoket æœåŠ¡å°†æ•°æ®å‘é€å‡ºå»
4. å…³é—­ socket æœåŠ¡
*/

public class UDPServer { 
	public static void main(String[] args)throws IOException{
		String str_send = "Hello UDPclient";
		byte[] buf = new byte[1024];
		//æœåŠ¡ç«¯åœ¨3000ç«¯å£ç›‘å¬æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä¸æŒ‡å®šã€éšæœºå‘é€
		DatagramSocket ds = new DatagramSocket(3000);
		//æ¥æ”¶ä»å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ•°æ®
		DatagramPacket dp_receive = new DatagramPacket(buf, 1024);
		System.out.println("server is onï¼Œwaiting for client to send data......");
		boolean f = true;
		while(f){
			//æœåŠ¡å™¨ç«¯æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„æ•°æ®
			ds.receive(dp_receive);
			System.out.println("server received data from clientï¼š");
			String str_receive = new String(dp_receive.getData(),0,dp_receive.getLength()) + 
					" from " + dp_receive.getAddress().getHostAddress() + ":" + dp_receive.getPort();
			System.out.println(str_receive);
			//å°†æ•°æ®ã€ç›®çš„å’Œç«¯å£å°è£…æˆåŒ…ï¼Œå‘é€åˆ°å®¢æˆ·ç«¯çš„3000ç«¯å£
			DatagramPacket dp_send= new DatagramPacket(str_send.getBytes(),str_send.length(),dp_receive.getAddress(),9000);
			ds.send(dp_send);
			//ç”±äºdp_receiveåœ¨æ¥æ”¶äº†æ•°æ®ä¹‹åï¼Œå…¶å†…éƒ¨æ¶ˆæ¯é•¿åº¦å€¼ä¼šå˜ä¸ºå®é™…æ¥æ”¶çš„æ¶ˆæ¯çš„å­—èŠ‚æ•°ï¼Œ
			//æ‰€ä»¥è¿™é‡Œè¦å°†dp_receiveçš„å†…éƒ¨æ¶ˆæ¯é•¿åº¦é‡æ–°ç½®ä¸º1024
			dp_receive.setLength(1024);
		}
		ds.close();
	}
}
```

åˆ›å»º UDP æ¥æ”¶ç«¯

```java
/*
1. å»ºç«‹ UDP çš„ socket æœåŠ¡
2. åˆ›å»ºæ•°æ®åŒ…ï¼Œç”¨æ¥æ¥æ”¶æ•°æ®
3. ä½¿ç”¨ scoket å°†æ•°æ®å­˜å‚¨åœ¨æ•°æ®åŒ…ä¸­
4. å…³é—­ socket æœåŠ¡
*/
public class UDPClient {
	private static final int TIMEOUT = 5000;  //è®¾ç½®æ¥æ”¶æ•°æ®çš„è¶…æ—¶æ—¶é—´
	private static final int MAXNUM = 5;      //è®¾ç½®é‡å‘æ•°æ®çš„æœ€å¤šæ¬¡æ•°
	public static void main(String args[])throws IOException{
		String str_send = "Hello UDPserver";
		byte[] buf = new byte[1024];
		//å®¢æˆ·ç«¯åœ¨9000ç«¯å£ç›‘å¬æ¥æ”¶åˆ°çš„æ•°æ®
		DatagramSocket ds = new DatagramSocket(9000);
		InetAddress loc = InetAddress.getLocalHost();
		//å®šä¹‰ç”¨æ¥å‘é€æ•°æ®çš„DatagramPacketå®ä¾‹
		DatagramPacket dp_send= new DatagramPacket(str_send.getBytes(),str_send.length(),loc,3000);
		//å®šä¹‰ç”¨æ¥æ¥æ”¶æ•°æ®çš„DatagramPacketå®ä¾‹
		DatagramPacket dp_receive = new DatagramPacket(buf, 1024);
		//æ•°æ®å‘å‘æœ¬åœ°3000ç«¯å£
		ds.setSoTimeout(TIMEOUT);              //è®¾ç½®æ¥æ”¶æ•°æ®æ—¶é˜»å¡çš„æœ€é•¿æ—¶é—´
		int tries = 0;                         //é‡å‘æ•°æ®çš„æ¬¡æ•°
		boolean receivedResponse = false;     //æ˜¯å¦æ¥æ”¶åˆ°æ•°æ®çš„æ ‡å¿—ä½
		//ç›´åˆ°æ¥æ”¶åˆ°æ•°æ®ï¼Œæˆ–è€…é‡å‘æ¬¡æ•°è¾¾åˆ°é¢„å®šå€¼ï¼Œåˆ™é€€å‡ºå¾ªç¯
		while(!receivedResponse && tries<MAXNUM){
			//å‘é€æ•°æ®
			ds.send(dp_send);
			try{
				//æ¥æ”¶ä»æœåŠ¡ç«¯å‘é€å›æ¥çš„æ•°æ®
				ds.receive(dp_receive);
				//å¦‚æœæ¥æ”¶åˆ°çš„æ•°æ®ä¸æ˜¯æ¥è‡ªç›®æ ‡åœ°å€ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸
				if(!dp_receive.getAddress().equals(loc)){
					throw new IOException("Received packet from an umknown source");
				}
				//å¦‚æœæ¥æ”¶åˆ°æ•°æ®ã€‚åˆ™å°†receivedResponseæ ‡å¿—ä½æ”¹ä¸ºtrueï¼Œä»è€Œé€€å‡ºå¾ªç¯
				receivedResponse = true;
			}catch(InterruptedIOException e){
				//å¦‚æœæ¥æ”¶æ•°æ®æ—¶é˜»å¡è¶…æ—¶ï¼Œé‡å‘å¹¶å‡å°‘ä¸€æ¬¡é‡å‘çš„æ¬¡æ•°
				tries += 1;
				System.out.println("Time out," + (MAXNUM - tries) + " more tries..." );
			}
		}
		if(receivedResponse){
			//å¦‚æœæ”¶åˆ°æ•°æ®ï¼Œåˆ™æ‰“å°å‡ºæ¥
			System.out.println("client received data from serverï¼š");
			String str_receive = new String(dp_receive.getData(),0,dp_receive.getLength()) + 
					" from " + dp_receive.getAddress().getHostAddress() + ":" + dp_receive.getPort();
			System.out.println(str_receive);
			//ç”±äºdp_receiveåœ¨æ¥æ”¶äº†æ•°æ®ä¹‹åï¼Œå…¶å†…éƒ¨æ¶ˆæ¯é•¿åº¦å€¼ä¼šå˜ä¸ºå®é™…æ¥æ”¶çš„æ¶ˆæ¯çš„å­—èŠ‚æ•°ï¼Œ
			//æ‰€ä»¥è¿™é‡Œè¦å°†dp_receiveçš„å†…éƒ¨æ¶ˆæ¯é•¿åº¦é‡æ–°ç½®ä¸º1024
			dp_receive.setLength(1024);   
		}else{
			//å¦‚æœé‡å‘MAXNUMæ¬¡æ•°æ®åï¼Œä»æœªè·å¾—æœåŠ¡å™¨å‘é€å›æ¥çš„æ•°æ®ï¼Œåˆ™æ‰“å°å¦‚ä¸‹ä¿¡æ¯
			System.out.println("No response -- give up.");
		}
		ds.close();
	}  
} 
```



### 7âƒ£ï¸TCP â€”â€” å®¢æˆ·ç«¯

å‘æœåŠ¡å™¨å‘é€æ•°æ®ã€‚

1. åˆ›å»ºå®¢æˆ·ç«¯ Socket çš„æœåŠ¡ã€‚
2. è·å¾— socket ä¸­çš„è¾“å‡ºæµã€‚ï¼ˆå› ä¸ºè¿™æ˜¯ Socket ç½‘ç»œæµï¼Œæ‰€ä»¥æ˜¯åº•å±‚çš„ï¼‰ã€‚
3. é€šè¿‡è¾“å‡ºæµå°†æŒ‡å®šæ•°æ®å‘é€å‡ºå»ã€‚
4. å…³é—­èµ„æºã€‚

```java
Socket s = new Socket("192.168.137.1",8888);
// å‘é€æ•°æ®
OutputStream os = s.getOutputStream();
os.write("ä½ å¥½ï¼ŒæœåŠ¡å™¨".getBytes());
// è¯»å–æ•°æ®
InputStream is = s.getInputStream();
byte[] buff = new byte[1024];
int len = is.read(buff);
System.out.println(new String(buff,0,len));
s.close(); //å…³é—­å®¢æˆ·ç«¯
```



### 8âƒ£ï¸TCP â€”â€” æœåŠ¡ç«¯

æ¥æ”¶å®¢æˆ·ç«¯æ•°æ®ã€‚

1. åˆ›å»ºæœåŠ¡ç«¯ Socket çš„æœåŠ¡ï¼Œé€šè¿‡ ServerSocket å»ºç«‹ã€‚
2. æœåŠ¡å™¨å¿…é¡»å¯¹å¤–æä¾›ä¸€ä¸ªç«¯å£ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¸èƒ½è¿æ¥ã€‚
3. è·å–è¿æ¥è¿‡æ¥çš„å®¢æˆ·ç«¯å¯¹è±¡ã€‚
4. é€šè¿‡å®¢æˆ·ç«¯å¯¹è±¡è·å– Socket æµï¼Œè¯»å–å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ã€‚
5. å…³é—­èµ„æºã€‚å…³å®¢æˆ·ç«¯ã€å…³æœåŠ¡ç«¯ã€‚

```java
// æœåŠ¡å™¨ï¼Œç›‘å¬ç«¯å£
ServerSocket ss = new ServerSocket(8888);
Socket s = ss.accept();//  é˜»å¡å¼ï¼šä¸€ç›´ç­‰å¾…å®¢æˆ·ç«¯å¯¹è±¡åˆ°æ¥
InputStream is = s.getInputStream();//å®¢æˆ·ç«¯çš„è¾“å…¥æµ
// è¯»æ•°æ®
byte[] buff = new byte[1024];
int len = is.read(buff);
String str = new String(buff,0,len);
System.out.println(str);
// å‘é€æ•°æ®ç»™å®¢æˆ·ç«¯
OutputStream os = s.getOutputStream();
os.write("å†è§ï¼Œå®¢æˆ·ç«¯".getBytes());
s.close();//å…³é—­å®¢æˆ·ç«¯ï¼Œé‡Šæ”¾èµ„æº
ss.close();//å…³é—­æœåŠ¡å™¨
```



### 9âƒ£ï¸å…³äº TCP ä¼ è¾“çš„å°ç»ƒä¹ 

#### é—®é¢˜ 1

å®¢æˆ·ç«¯å‘é€ä¸€æ®µå­—æ¯ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ¥æ”¶åˆ°å­—æ¯åè½¬æ¢æˆå¤§å†™ï¼Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚å½“å®¢æˆ·ç«¯å‘é€ â€œoverâ€ æ—¶ï¼Œæ–­å¼€è¿æ¥ã€‚

å®¢æˆ·ç«¯

```java
// å®¢æˆ·ç«¯ï¼šé”®ç›˜å½•å…¥å­—æ¯ï¼Œå¹¶å‘é€å­—æ¯å¹¶æ¥å—æœåŠ¡å™¨è¿”å›çš„å¤§å†™å­—æ¯å¹¶æ‰“å°
private static void () throws IOException {
  Socket s = new Socket("192.168.137.1", 8888);
  //æ¥å—é”®ç›˜è¾“å…¥çš„æ•°æ®
  BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
  //å‘é€ç»™æœåŠ¡å™¨
  PrintWriter outpw = new PrintWriter(s.getOutputStream(), true); 
  //è¯»å–æœåŠ¡å™¨çš„æ•°æ®
  BufferedReader inbr = new BufferedReader(new InputStreamReader(s.getInputStream()));

  String str = null;
  while ((str = br.readLine()) != null) {  
    //è¿™ä¸ªé˜»å¡å¼æ–¹æ³•ï¼Œå¿…é¡»ä»¥æ¢è¡Œæ ‡è®°ç»“æŸ
    if (str.equals("over")){
      System.out.println("é€šä¿¡ç»“æŸï¼");
      break;
    }
		//å‘é€ç»™æœåŠ¡å™¨  ç»“åˆè‡ªåŠ¨åˆ·æ–°
    outpw.println(str);  
    System.out.println("è½¬æ¢æˆåŠŸï¼ã€‚ã€‚ã€‚" + inbr.readLine());
  }
  s.close();  
}
```

æœåŠ¡å™¨ç«¯

```java
/*æœåŠ¡å™¨ç«¯ï¼šè¯»å–æ¥è‡ªå®¢æˆ·ç«¯çš„å­—æ¯ï¼Œå°†å…¶è½¬åŒ–æˆå¤§å†™ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯*/
private static void () throws IOException {
  /*æœåŠ¡å™¨ï¼Œç›‘å¬ç«¯å£*/
  ServerSocket ss = new ServerSocket(8888);
  // é˜»å¡å¼ï¼šä¸€ç›´ç­‰å¾…å®¢æˆ·ç«¯å¯¹è±¡åˆ°æ¥
  Socket s = ss.accept();
  // è¯»å–å®¢æˆ·ç«¯çš„æ•°æ®æº
  BufferedReader inbr = new BufferedReader(new InputStreamReader(s.getInputStream()));
	// è£…é¥°ï¼Œå‘é€ç»™å®¢æˆ·ç«¯
  PrintWriter outpw = new PrintWriter(s.getOutputStream(),true);  
  String str = null;
  while ((str = inbr.readLine())!=null){  
    // å½“å®¢æˆ·ç«¯çš„Socketç»“æŸåï¼Œè¿™ä¸ªå°±ä¼šè¯»åˆ°ç©ºï¼Œæ‰€ä»¥æœåŠ¡å™¨ä¹Ÿä¼šç»“æŸ
    System.out.println(str);
    //ä½¿ç”¨è‡ªåŠ¨åˆ·æ–°æµï¼Œè¦æ³¨æ„æŒ‡å®šæ‰“å°çš„æ–¹æ³•
    outpw.println(str.toUpperCase());  
  }
  ss.close();
  s.close();
}
```



#### é—®é¢˜ 2

å®¢æˆ·ç«¯ä¸Šä¼ ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ˆå­—ç¬¦æ–‡ä»¶ï¼‰åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä¿å­˜åˆ°ç¡¬ç›˜å†…ã€‚

å®¢æˆ·ç«¯

```java
/*å®¢æˆ·ç«¯ï¼šä¸Šä¼ ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œåˆ°æœåŠ¡å™¨ã€‚*/
private static void uploadFile() throws IOException{
  //è¯»å–æ–‡æœ¬çš„è¾“å…¥æµ
  BufferedReader br = new BufferedReader(new FileReader("client.txt"));
  //åˆ›å»ºå®¢æˆ·ç«¯Socket
  Socket s = new Socket("192.168.137.1", 8888);
  PrintWriter outpw = new PrintWriter(s.getOutputStream(), true);  //å‘é€ç»™æœåŠ¡å™¨
  String line = null;
  while((line = br.readLine())!=null){
    outpw.println(line);
  }
  s.shutdownOutput();  //åœ¨æµçš„æœ«å°¾å¤„åŠ ä¸Šç»“æŸæ ‡è®°,å‘Šè¯‰æœåŠ¡å™¨ä¼ é€ç»“æŸ
  BufferedReader inbr = new BufferedReader(new InputStreamReader(s.getInputStream()));//è¯»å–æœåŠ¡å™¨çš„æ•°æ®
  line = inbr.readLine();
  System.out.println(line);
  s.close(); //è¿™ä¸ªç»“æŸï¼Œä¹Ÿä¼šå‘Šè¯‰æœåŠ¡å™¨ç»“æŸ
}
```

æœåŠ¡å™¨ç«¯

```java
/*æœåŠ¡å™¨ï¼šå°†å®¢æˆ·ç«¯å‘é€çš„æ–‡æœ¬æ–‡ä»¶æ•°æ®ï¼Œæ¥å—å¹¶å­˜åˆ°ç¡¬ç›˜ä¸­*/
private static void uploadFile() throws IOException {
  //è¾“å‡ºåˆ°æ–‡ä»¶
  PrintWriter pw = new PrintWriter(new FileWriter("server.txt"),true);
  //åˆ›å»ºæœåŠ¡ç«¯socket
  ServerSocket ss = new ServerSocket(8888);
  Socket s = ss.accept();//è·å–socketå¯¹è±¡
  String ip = s.getInetAddress().getHostAddress();
  System.out.println(ip+"......è¿æ¥æˆåŠŸ");
  //ç”¨äºè¯»å–å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®
  BufferedReader inbr = new BufferedReader(new InputStreamReader(s.getInputStream()));//è¯»å–å®¢æˆ·ç«¯çš„æ•°æ®æº
  String line = null;
  while((line = inbr.readLine())!=null){
    pw.println(line);  //è¾“å‡ºåˆ°æ–‡ä»¶
  }
  System.out.println("æ–‡ä»¶ä¿å­˜æˆåŠŸ");
  PrintWriter outpw = new PrintWriter(s.getOutputStream(),true);  //è£…é¥°ï¼šå‘é€ç»™å®¢æˆ·ç«¯
  outpw.println("ä¸Šä¼ æˆåŠŸï¼");

  ss.close();
  s.close();
}
```



### 1âƒ£ï¸0âƒ£ï¸ç½‘ç»œæ¶æ„

- C/S æ¶æ„ ï¼ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ï¼‰

  åœ¨è®¡ç®—æœºä¸Šçš„åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚æ¸¸æˆå®¢æˆ·ç«¯ç­‰ï¼Œå¼€å‘æˆæœ¬è¾ƒé«˜ï¼Œå› ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½è¦å¼€å‘ã€‚

- B/S  æ¶æ„ ï¼ˆæµè§ˆå™¨å’ŒæœåŠ¡å™¨ï¼‰

  å¾ˆæ˜æ˜¾å°±æ˜¯æµè§ˆå™¨ç›´æ¥å’ŒæœåŠ¡ç«¯ç«¥å­å°¿ã€‚æµè§ˆå™¨ä¸éœ€è¦å¼€å‘ï¼Œç›´æ¥ä½¿ç”¨ã€‚





## 17. åå°„

**æ¦‚å¿µ** 

èƒ½å¤ŸåŠ¨æ€åœ°è·å–ç±»ä¸­ä¿¡æ¯å¹¶è°ƒç”¨ç±»ä¸­å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¹‹ä¸º Java çš„åå°„æœºåˆ¶ã€‚å¯¹ç±»è¿›è¡Œè§£å‰–ã€‚

**åŸºæœ¬åº”ç”¨ä¸¾ä¾‹** 

å¦‚æœæƒ³è®©TomcatæœåŠ¡å™¨è¿è¡Œå¼€å‘è€…å†™çš„ç¨‹åºæ¥å¤„ç†å…·ä½“çš„è¯·æ±‚å’Œåº”ç­”ï¼Œä¸ä¿®æ”¹tomcatå·²ç»å†™å¥½çš„ç¨‹åºã€‚

å¯ä»¥å†™ä¸€ä¸ªç±»æ–‡ä»¶ï¼Œè¿™ä¸ªç±»å®ç°Servletæ¥å£ï¼Œç„¶åä¿®æ”¹tomcatçš„é…ç½®æ–‡ä»¶web.xmlã€‚

è¿™æ ·å°±å¯ä»¥æ‰§è¡Œå¼€å‘è€…å†™çš„ç±»æ–‡ä»¶äº†ã€‚

å³tomcatä¸­çš„ç¨‹åºä»£ç ä¸­æ²¡æœ‰newä¸€ä¸ªServletçš„è¿™ä¸ªç±»ï¼Œè€Œæ˜¯åŠ¨æ€çš„è·å–ç±»çš„å†…å®¹ï¼Œåœ¨è¿è¡Œæ—¶å¯ä»¥è·å–åˆ°å®šä¹‰äº†å¤„ç†è¯·æ±‚å’Œåº”ç­”æ–¹å¼çš„MyServletç±»çš„ç›¸å…³ã€‚

è¿™é‡Œå°±ç”¨äº†åå°„æœºåˆ¶å»åŠ¨æ€è·å–ç±»çš„å†…å®¹ã€‚

**åå°„æœºåˆ¶çš„å†…éƒ¨åŸç†** 

æœ‰ä¸€ä¸ªç±»å« Class ï¼ˆè¿™æ˜¯ä¸€ä¸ªè·å–**å­—èŠ‚ç **ç±»ï¼‰ï¼Œå¯ä»¥è¯»å‡ºä¸€ä¸ªç±»æ–‡ä»¶çš„å­—èŠ‚ç æ–‡ä»¶çš„å†…å®¹ã€‚åå°„å°±æ˜¯ä¾é è¿™ä¸ª Class æ¥å®Œæˆçš„ï¼Œåªè¦è·å–å­—èŠ‚ç æ–‡ä»¶ï¼Œé€šè¿‡ Class ç±»å°±å¯ä»¥è·å–å…¶ä¸­çš„å†…å®¹ï¼Œæ¯”å¦‚å­—æ®µã€å‡½æ•°ã€æ„é€ æ–¹æ³•ç­‰ã€‚



**è·å–å­—èŠ‚ç æ–‡ä»¶å¯¹è±¡** 

```java
// 1.é€šè¿‡å­—ç¬¦ä¸²è·å–Classå¯¹è±¡ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å¿…é¡»å¸¦ä¸Šå®Œæ•´è·¯å¾„å
Class studentClass = Class.forName("com.test.reflection.Student"); // æ ¹æ®ç±»åè½¬æˆå­—èŠ‚ç å¯¹è±¡
// 2.é€šè¿‡ç±»çš„classå±æ€§
Class studentClass2 = Student.class;
// 3.é€šè¿‡å¯¹è±¡çš„getClass()å‡½æ•°
Student studentObject = new Student();
Class studentClass3 = studentObject.getClass();
```

- ç¬¬ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡ç±»çš„å…¨è·¯å¾„å­—ç¬¦ä¸²è·å– Class å¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¹³æ—¶æœ€å¸¸ç”¨çš„åå°„è·å– Class å¯¹è±¡çš„æ–¹æ³•ï¼›
- ç¬¬äºŒç§æ–¹æ³•æœ‰é™åˆ¶æ¡ä»¶ï¼šéœ€è¦å¯¼å…¥ç±»çš„åŒ…ï¼›
- ç¬¬ä¸‰ç§æ–¹æ³•å·²ç»æœ‰äº† Student å¯¹è±¡ï¼Œä¸å†éœ€è¦åå°„ã€‚

é€šè¿‡è¿™ä¸‰ç§æ–¹å¼è·å–åˆ°çš„ Class å¯¹è±¡æ˜¯åŒä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ Java è¿è¡Œæ—¶ï¼Œæ¯ä¸€ä¸ªç±»åªä¼šç”Ÿæˆä¸€ä¸ª Class å¯¹è±¡ã€‚



**è·å–æ„é€ æ–¹æ³•** 

æŠŠæ„é€ å‡½æ•°å°è£…æˆ Constructorã€‚

- è·å–ç©ºå‚æ•°æ„é€ å‡½æ•°ï¼š

  ```java
  Class cla = Class.forName("CollectionDemo.Person"); // æ ¹æ®ç±»åè½¬æ¢æˆå­—èŠ‚ç å¯¹è±¡
  Object obj = cla.newInstance(); // æ ¹æ®ç©ºå‚æ•°æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡
  ```

  ä½†å¦‚æœå­—èŠ‚ç ä¸­ç±»æ²¡æœ‰ç©ºå‚æ•°æ„é€ å‡½æ•°å°±ä¼šå‘ç”Ÿ `InstantiationException`ã€‚

- è·å–æŒ‡å®šå‚æ•°çš„æ„é€ å‡½æ•°

  è·å–æ„é€ æ–¹æ³•åŒæ ·åŒ…å«äº†ä¸¤ä¸ª APIï¼šç”¨äºè·å–æ‰€æœ‰æ„é€ æ–¹æ³•çš„ `getDeclaredConstructors`å’Œç”¨äºè·å–å…¬æœ‰æ„é€ æ–¹æ³•çš„`getConstructors`:

  ```java
  // æ ¹æ®å­—èŠ‚ç å¯¹è±¡è·å–æŒ‡å®šå‚æ•°çš„æ„é€ å‡½æ•°å¯¹è±¡
  Constructor constructor = cla.getConstructor(String.class, int.class);
  // æ ¹æ®æ„é€ å‡½æ•°å¯¹è±¡çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå»ºç«‹ç±»çš„ä¸€ä¸ªæ–°å®ä¾‹
  Object obj = constructor.newInstance("å°æ˜", 20);
  ```



**è·å–å­—èŠ‚ç æ–‡ä»¶ä¸­çš„å­—æ®µ** 

æŠŠæ‰€æœ‰å­—æ®µå°è£…è£…æˆäº†å¯¹è±¡ field

```java
// å¯è·å–æ‰€æœ‰å­—æ®µåŒ…æ‹¬ç§æœ‰
Field field = cla.getDeclaredField("age");
// ä¸å¯è·å–ç§æœ‰å­—æ®µ
// Field field = cla.getField("age");
// æš´åŠ›è®¿é—®ï¼Œå–æ¶ˆ private ç§æœ‰åŒ–æƒé™ï¼Œä¹‹åå°±å¯ä»¥è·å–æŒ‡å®šå¯¹è±¡å­—æ®µçš„å€¼
field.setAccessible(true);
// æŒ‡å®šå¯¹è±¡çš„å€¼
System.out.println(field.get(obj));
```



**è·å–å­—èŠ‚ç æ–‡ä»¶ä¸­çš„æ–¹æ³•** 

```java
// è·å–å­—èŠ‚ç å¯¹è±¡çš„æŸä¸ªæ–¹æ³•å¯¹è±¡
Method method = cla.getDeclaredField("getName", null);
// è°ƒç”¨æŸä¸ªå¯¹è±¡çš„æ–¹æ³•
Object name = method.invoke(obj, null);
```



**æ€»ç»“**

å¯¹äºä¸€ä¸ªç»™å®šç±»åçš„ class æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ Class ä¸­çš„ forName æ–¹æ³•è·å–è¯¥ç±»çš„å­—èŠ‚ç å¯¹è±¡ï¼Œæ ¹æ®å­—èŠ‚ç å¯¹è±¡å¯ä»¥è·å–è¯¥ç±»ä¸­çš„æ„é€ å‡½æ•°å¯¹è±¡ Constructorã€å­—æ®µå¯¹è±¡ Field ä»¥åŠæ–¹æ³•å¯¹è±¡ Methodã€‚

æ ¹æ®æ„é€ å‡½æ•°å¯¹è±¡å¯ä»¥åˆ›å»ºè¯¥ç±»çš„ä¸€ä¸ªå®éªŒå¯¹è±¡ï¼Œæ ¹æ®è¿™ä¸ªå®ä¾‹åŒ–å¯¹è±¡ï¼Œè°ƒç”¨ Field å’Œ Methodï¼Œå¯ä»¥è°ƒç”¨è¯¥å¯¹è±¡çš„å­—æ®µå’Œæ–¹æ³•ã€‚

ä¸Šè¿°å½“ä¸­ï¼Œåœ¨å‡ ä¹å®Œå…¨ä¸çŸ¥ç±»ä¸­å­—æ®µå’Œæ–¹æ³•åç§°çš„æƒ…å†µï¼Œå®Œæˆå¯¹è±¡å¯¹å…¶çš„è°ƒç”¨ï¼Œè¿™æ ·å¤§å¤§æé«˜äº†æ‰©å±•æ€§ã€‚

**æ‰©å±•æ€§çš„ä½“ç°** 

æ¯”å¦‚ Tomcatï¼Œä¸éœ€è¦ä¿®æ”¹ Tomcat å†…éƒ¨çš„ç¨‹åºï¼Œå°±å¯ä»¥è¿è¡Œå¤–éƒ¨æ·»åŠ çš„ class æ–‡ä»¶ï¼Œåªéœ€ä¿®æ”¹ Tomcat ç›¸åº”çš„é…ç½®æ–‡ä»¶å³å¯ã€‚





## 18. æ­£åˆ™è¡¨è¾¾å¼

**æ¦‚å¿µ** 

ç”¨äºæ“ä½œå­—ç¬¦ä¸²ï¼ˆåŒ¹é…ä»»æ„æ ¼å¼çš„å­—ç¬¦ä¸²ï¼‰ï¼Œé€šè¿‡ç‰¹å®šçš„ç¬¦å·æ¥ä½“ç°çš„ã€‚ç®€åŒ–ä¹¦å†™ã€‚

**ä½œç”¨** 

- åŒ¹é…

  ä½¿ç”¨ String ç±»ä¸­çš„ matches æ–¹æ³•

- åˆ‡å‰²

  ä½¿ç”¨ String ç±»ä¸­çš„ split æ–¹æ³•ï¼Œå…¶ä¸­æ­£åˆ™æœ‰ä¸ªæ•è·ç»„çš„æ¦‚å¿µã€‚

- æ›¿æ¢

  ä½¿ç”¨ String ç±»ä¸­çš„ replaceAll æ–¹æ³•

  ```java
  // æ›¿æ¢æˆ 123****7890
  String tel = "12300007890";
  // ä¸€ä¸ªæ‹¬å·ä¸ºä¸€ç»„ï¼Œåé¢ç”¨$ç¬¦å·å¯ä»¥è°ƒç”¨ç»„
  String str = tel.replaceAll("(\\d{3})(\\d{4})(\\d{4})", "$1****$3");
  ```

- è·å–(Java.util.regex)

  ```java
  // å°†æ­£åˆ™å¯¹è±¡è¿›è¡Œå°è£…
  Pattern p = Pattern.compile("a*b");
  // æ­£åˆ™å¯¹è±¡å’Œå­—ç¬¦ä¸²è¿›è¡Œå…³è”ï¼Œè·å¾— Matcher å¯¹è±¡
  Matcher m = p.matcher("aaaaab");
  // ä½¿ç”¨ Matcher å¯¹è±¡çš„åŒ¹é…æ–¹æ³•ï¼Œè¿›è¡ŒåŒ¹é…
  boolean b = m.matcher();
  ```

  ä¾‹å­

  ```java
  // å–å‡ºå…¶ä¸­åªæœ‰ä¸‰ä¸ªå­—ç¬¦çš„å•è¯
  String str = "wo shi yi ge hao ren, ming tian jian";
  // æŒ‡å®šæ­£åˆ™å¯¹è±¡
  Pattern pattern = Pattern.compile("\\b[a-z]{3}\\b");
  // å°†æ­£åˆ™å¯¹è±¡å’Œå­—ç¬¦ä¸²è¿›è¡Œç»‘å®š
  Matcher matcher = pattern.matcher(str);
  // è¿›è¡ŒåŒ¹é…
  while(matcher.find()){
    // è·å–åŒ¹é…çš„å­ä¸²
    System.out.println(matcher.group());
  }
  ```

  














# Linux





## 1. 文件系统的原理，inode和block

### 文件系统的组成

**inode** 

一个文件占用一个 inode，记录文件的属性，同时记录此文件内容所在的 block 编号。

区别目录：建立目录时，会**分配一个 inode 与至少一个 block**。block 记录的内容是目录下所有文件的 inode 编号以及文件名。

**block** 

记录文件的内容，文件太大时，会占用多个 block。



### inode

inode 具体包括以下信息

- 权限(read/write/excute)
- 拥有者与群组(owner/group)
- 容量；
- 建立或状态改变的时间(ctime)
- 最近一次的读取时间(atime)
- 最近修改的时间(mtime)
- 定义文件特性的旗标(flag)，如 SetID...
- 该文件真正内容的指向(pointer)

inode具有以下特点

- 每个 inode 大小均固定为 128 bytes
- 每个文件都仅会占用一个 inode





## 2. ⭐️ 硬链接和软连接的区别

**硬链接(hard link)** 

A是B的硬链接（A和B都是文件名），则A的目录项中的inode节点号与B的目录项中的inode节点号相同，即**一个inode节点对应两个不同的文件**名，两个文件名指向同一个文件，A和B对文件系统来说是完全平等的。

如果删除了其中一个，对另外一个没有影响。每增加一个文件名，inode节点上的链接数增加一，每删除一个对应的文件名，inode节点上的链接数减一，直到为0，inode节点和对应的数据块被回收。注：文件和文件名是不同的东西，rm A删除的只是A这个文件名，而A对应的数据块（文件）只有在inode节点链接数减少为0的时候才会被系统回收。

1. **不可以跨分区创建硬链接** 
2. **不可以对目录创建硬链接** 
3. 硬链接文件和源文件使用相同的inode号码
4. 删除硬链接或源文件不对对方产生任何影响，直至删除使用该inode号码的最后一个文件



**软链接(soft link)** 

A是B的软链接（A和B都是文件名），A的目录项中的inode节点号与B的目录项中的inode节点号不相同，A和B指向的是两个不同的inode，继而指向两块不同的数据块。但是A的数据块中存放的只是B的路径名（可以根据这个找到B的目录项）。

A和B之间是“主从”关系，如果B被删除了，A仍然存在（因为两个是不同的文件），但指向的是一个无效的链接。

1. 可以跨分区

2. 可以对目录创建软链接

3. 软链接文件和源文件使用不同的inode号码

4. 删除源文件、目录会导致软链接失效





## 3. 僵尸进程和孤儿进程的区别

[孤儿进程与僵尸进程总结](https://www.cnblogs.com/Anker/p/3271773.html) 

从 SIGCHLD 分析产生僵尸进程的原因

**孤儿进程**

一个父进程退出，而它的一个或多个子进程还在运行，那么那些子进程将成为孤儿进程。孤儿进程将被init进程(进程号为1)所收养，并由init进程对它们完成状态收集工作。



**僵尸进程** 

一个进程使用fork创建子进程，如果子进程退出，而父进程并没有调用wait或waitpid获取子进程的状态信息，那么子进程的进程描述符仍然保存在系统中。这种进程称之为僵尸进程。





## 4. ⭐️ 常用指令

1. `tail -n 1000` ：显示最后 1000 行

2. `tail -n +1000` ：从第 1000 行开始显示，显示第 1000 行之后的

3. `tail -f` ：动态显示文件

4. `head -n 1000` ：显示前面 1000 行

5. sed 命令查看中间几行

   `sed -n '5, 10p' filename` ：只查看文件的第 5 行到第 10 行

6. `top` 指令：动态显示总的 cpu 和内存情况，以及每个进程的 cpu 和内存占用率

7. `ps` ：查看当前运行的类型

8. `netstat` ：观察端口占用，加上 grep 过滤端口 `netstat -apn | grep 8080` 

9. `df` ：查看所有磁盘的使用情况

10. `du` ：查看当前指定文件或目录（会递归显示子目录）占用磁盘空间大小

11. `lsof` ：查看一个进程打开了哪些文件

12. 查找指令

    `which` ：可执行文件

    `whereis` ：用于程序名搜索，而且只搜索二进制文件

    `locate` ：从本机数据库中搜索

    `find` ：全盘扫描



























